<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="/css/login.css">
</head>
<body>
    <div class="container">
        <div class="left-box">
            <img src="images/ku.png" alt="KU">
        </div>
        <div class="right-box">
            <div class="logo">
                <h1>SIGN IN</h1>
            </div>
            <div class="form">
                <form id="login-form" action="/login" method="post">
                    <label for="username">UserID</label>
                    <input type="text" id="username" name="username">
                    <label for="password">Password</label>
                    <input type="password" id="password" name="password">
                    <input type="submit" value="Sign In">
                </form>
                <div id="message"></div> <!-- 메시지를 표시할 영역 -->
            </div>
            <div class="links">
                <a href="/mainpage">Home Page</a>
                <a href="/signup" id="signUp">Sign up</a>
            </div>
        </div>
    </div>
    <script>
      <% if (typeof message !== 'undefined') { %>
            const message = '<%= message %>';
            alert(message);
        <% } %>
        
        window.onload = function () {
          const loginForm = document.getElementById('login-form');
          const messageElement = document.getElementById('message');
      
          loginForm.addEventListener('submit', async function (event) {
            event.preventDefault();
      
            const formData = {
              username: document.getElementById('username').value,
              password: document.getElementById('password').value,
            };
      
            try {
              const response = await fetch('/login', {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json'
                },
                body: JSON.stringify(formData)
              });
      
              const data = await response.json();
      
              if (response.ok) {
                // 로그인 성공 시 홈페이지로 리다이렉트
                window.location.href = '/mainpage';
              } else {
                // 로그인 실패 시 에러 메시지 표시
                console.error('로그인 실패:', data.error);
                messageElement.innerHTML = data.error;
              }
            } catch (error) {
              console.error('로그인 요청 실패:', error);
            }
          });
        };
      </script>
</body>

</html>